{"remainingRequest":"G:\\pdf\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\pdf\\src\\components\\previewPDF.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"G:\\pdf\\src\\components\\previewPDF.vue","mtime":1611730765892},{"path":"G:\\pdf\\node_modules\\css-loader\\dist\\cjs.js","mtime":1603074898938},{"path":"G:\\pdf\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1608703742340},{"path":"G:\\pdf\\node_modules\\postcss-loader\\src\\index.js","mtime":1597828001655},{"path":"G:\\pdf\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1602294150526},{"path":"G:\\pdf\\node_modules\\vue-loader\\lib\\index.js","mtime":1608703742340}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoucHJldmlldy1wZGYgaDEgewogIG1hcmdpbjogMzBweCBhdXRvOwogIHRleHQtYWxpZ246IGNlbnRlcjsKICBmb250LWZhbWlseTogJ+Wui+S9kyc7CiAgbGV0dGVyLXNwYWNpbmc6IDJweDsKfQo="},{"version":3,"sources":["previewPDF.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsFA;AACA;AACA;AACA;AACA;AACA","file":"previewPDF.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"preview-pdf\">\n    <h1>PDF在线预览</h1>\n    <div :style=\"`margin:0 auto;width:${pdfWidth};`\">\n      <canvas\n        v-for=\"page in pdfPages\"\n        :key=\"page\"\n        :id=\"'pdfCanvas' + page\"\n      ></canvas>\n    </div>\n  </div>\n</template>\n<script>\nconst PDFJS = require('pdfjs-dist');\nPDFJS.GlobalWorkerOptions.workerSrc =\n  'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.5.207/pdf.worker.js';\nexport default {\n  data() {\n    return {\n      pdfPages: [], // 页数\n      pdfWidth: '', // 宽度\n      pdfSrc: '', // 地址\n      pdfDoc: '', // 文档内容\n      pdfScale: 1.0 // 放大倍数\n    };\n  },\n  mounted() {\n    this.getPdfUrl();\n  },\n  methods: {\n    getPdfUrl() {\n      // todo 请求后台，获取pdf的url，这里用的是线上的地址\n      this.pdfSrc =\n        'https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/web/compressed.tracemonkey-pldi-09.pdf';\n      this.loadFile(this.pdfSrc);\n    },\n    loadFile(url) {\n      let loadingTask = PDFJS.getDocument(url);\n      loadingTask.promise.then((pdf) => {\n        this.pdfDoc = pdf;\n        this.pdfPages = pdf.numPages;\n        this.$nextTick(() => {\n          this.renderPage(1);\n        });\n      });\n    },\n    renderPage(num) {\n      const that = this;\n      this.pdfDoc.getPage(num).then((page) => {\n        let canvas = document.getElementById('pdfCanvas' + num);\n        let ctx = canvas.getContext('2d');\n        let dpr = window.devicePixelRatio || 1;\n        let bsr =\n          ctx.webkitBackingStorePixelRatio ||\n          ctx.mozBackingStorePixelRatio ||\n          ctx.msBackingStorePixelRatio ||\n          ctx.oBackingStorePixelRatio ||\n          ctx.backingStorePixelRatio ||\n          1;\n        let ratio = dpr / bsr;\n        let viewport = page.getViewport({ scale: this.pdfScale });\n        canvas.width = viewport.width * ratio;\n        canvas.height = viewport.height * ratio;\n\n        canvas.style.width = viewport.width + 'px';\n\n        that.pdfWidth = viewport.width + 'px';\n\n        canvas.style.height = viewport.height + 'px';\n\n        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);\n        // 将 PDF 页面渲染到 canvas 上下文中\n        let renderContext = {\n          canvasContext: ctx,\n          viewport: viewport\n        };\n        page.render(renderContext);\n        if (this.pdfPages > num) {\n          this.renderPage(num + 1);\n        }\n      });\n    }\n  }\n};\n</script>\n<style>\n.preview-pdf h1 {\n  margin: 30px auto;\n  text-align: center;\n  font-family: '宋体';\n  letter-spacing: 2px;\n}\n</style>\n"]}]}