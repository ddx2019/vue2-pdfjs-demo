{"remainingRequest":"G:\\pdf\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\pdf\\src\\components\\previewPDF.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\pdf\\src\\components\\previewPDF.vue","mtime":1611730765892},{"path":"G:\\pdf\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1602294150526},{"path":"G:\\pdf\\node_modules\\babel-loader\\lib\\index.js","mtime":1606880660519},{"path":"G:\\pdf\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1602294150526},{"path":"G:\\pdf\\node_modules\\vue-loader\\lib\\index.js","mtime":1608703742340}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmNvbnN0IFBERkpTID0gcmVxdWlyZSgncGRmanMtZGlzdCcpOwpQREZKUy5HbG9iYWxXb3JrZXJPcHRpb25zLndvcmtlclNyYyA9CiAgJ2h0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL3BkZi5qcy8yLjUuMjA3L3BkZi53b3JrZXIuanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBkZlBhZ2VzOiBbXSwgLy8g6aG15pWwCiAgICAgIHBkZldpZHRoOiAnJywgLy8g5a695bqmCiAgICAgIHBkZlNyYzogJycsIC8vIOWcsOWdgAogICAgICBwZGZEb2M6ICcnLCAvLyDmlofmoaPlhoXlrrkKICAgICAgcGRmU2NhbGU6IDEuMCAvLyDmlL7lpKflgI3mlbAKICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRQZGZVcmwoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFBkZlVybCgpIHsKICAgICAgLy8gdG9kbyDor7fmsYLlkI7lj7DvvIzojrflj5ZwZGbnmoR1cmzvvIzov5nph4znlKjnmoTmmK/nur/kuIrnmoTlnLDlnYAKICAgICAgdGhpcy5wZGZTcmMgPQogICAgICAgICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vbW96aWxsYS9wZGYuanMvYmEyZWRlYWUvd2ViL2NvbXByZXNzZWQudHJhY2Vtb25rZXktcGxkaS0wOS5wZGYnOwogICAgICB0aGlzLmxvYWRGaWxlKHRoaXMucGRmU3JjKTsKICAgIH0sCiAgICBsb2FkRmlsZSh1cmwpIHsKICAgICAgbGV0IGxvYWRpbmdUYXNrID0gUERGSlMuZ2V0RG9jdW1lbnQodXJsKTsKICAgICAgbG9hZGluZ1Rhc2sucHJvbWlzZS50aGVuKChwZGYpID0+IHsKICAgICAgICB0aGlzLnBkZkRvYyA9IHBkZjsKICAgICAgICB0aGlzLnBkZlBhZ2VzID0gcGRmLm51bVBhZ2VzOwogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHRoaXMucmVuZGVyUGFnZSgxKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgcmVuZGVyUGFnZShudW0pIHsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CiAgICAgIHRoaXMucGRmRG9jLmdldFBhZ2UobnVtKS50aGVuKChwYWdlKSA9PiB7CiAgICAgICAgbGV0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZGZDYW52YXMnICsgbnVtKTsKICAgICAgICBsZXQgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CiAgICAgICAgbGV0IGRwciA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7CiAgICAgICAgbGV0IGJzciA9CiAgICAgICAgICBjdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fAogICAgICAgICAgY3R4Lm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwKICAgICAgICAgIGN0eC5tc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwKICAgICAgICAgIGN0eC5vQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fAogICAgICAgICAgY3R4LmJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwKICAgICAgICAgIDE7CiAgICAgICAgbGV0IHJhdGlvID0gZHByIC8gYnNyOwogICAgICAgIGxldCB2aWV3cG9ydCA9IHBhZ2UuZ2V0Vmlld3BvcnQoeyBzY2FsZTogdGhpcy5wZGZTY2FsZSB9KTsKICAgICAgICBjYW52YXMud2lkdGggPSB2aWV3cG9ydC53aWR0aCAqIHJhdGlvOwogICAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQgKiByYXRpbzsKCiAgICAgICAgY2FudmFzLnN0eWxlLndpZHRoID0gdmlld3BvcnQud2lkdGggKyAncHgnOwoKICAgICAgICB0aGF0LnBkZldpZHRoID0gdmlld3BvcnQud2lkdGggKyAncHgnOwoKICAgICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0ICsgJ3B4JzsKCiAgICAgICAgY3R4LnNldFRyYW5zZm9ybShyYXRpbywgMCwgMCwgcmF0aW8sIDAsIDApOwogICAgICAgIC8vIOWwhiBQREYg6aG16Z2i5riy5p+T5YiwIGNhbnZhcyDkuIrkuIvmlofkuK0KICAgICAgICBsZXQgcmVuZGVyQ29udGV4dCA9IHsKICAgICAgICAgIGNhbnZhc0NvbnRleHQ6IGN0eCwKICAgICAgICAgIHZpZXdwb3J0OiB2aWV3cG9ydAogICAgICAgIH07CiAgICAgICAgcGFnZS5yZW5kZXIocmVuZGVyQ29udGV4dCk7CiAgICAgICAgaWYgKHRoaXMucGRmUGFnZXMgPiBudW0pIHsKICAgICAgICAgIHRoaXMucmVuZGVyUGFnZShudW0gKyAxKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTsK"},{"version":3,"sources":["previewPDF.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"previewPDF.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"preview-pdf\">\n    <h1>PDF在线预览</h1>\n    <div :style=\"`margin:0 auto;width:${pdfWidth};`\">\n      <canvas\n        v-for=\"page in pdfPages\"\n        :key=\"page\"\n        :id=\"'pdfCanvas' + page\"\n      ></canvas>\n    </div>\n  </div>\n</template>\n<script>\nconst PDFJS = require('pdfjs-dist');\nPDFJS.GlobalWorkerOptions.workerSrc =\n  'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.5.207/pdf.worker.js';\nexport default {\n  data() {\n    return {\n      pdfPages: [], // 页数\n      pdfWidth: '', // 宽度\n      pdfSrc: '', // 地址\n      pdfDoc: '', // 文档内容\n      pdfScale: 1.0 // 放大倍数\n    };\n  },\n  mounted() {\n    this.getPdfUrl();\n  },\n  methods: {\n    getPdfUrl() {\n      // todo 请求后台，获取pdf的url，这里用的是线上的地址\n      this.pdfSrc =\n        'https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/web/compressed.tracemonkey-pldi-09.pdf';\n      this.loadFile(this.pdfSrc);\n    },\n    loadFile(url) {\n      let loadingTask = PDFJS.getDocument(url);\n      loadingTask.promise.then((pdf) => {\n        this.pdfDoc = pdf;\n        this.pdfPages = pdf.numPages;\n        this.$nextTick(() => {\n          this.renderPage(1);\n        });\n      });\n    },\n    renderPage(num) {\n      const that = this;\n      this.pdfDoc.getPage(num).then((page) => {\n        let canvas = document.getElementById('pdfCanvas' + num);\n        let ctx = canvas.getContext('2d');\n        let dpr = window.devicePixelRatio || 1;\n        let bsr =\n          ctx.webkitBackingStorePixelRatio ||\n          ctx.mozBackingStorePixelRatio ||\n          ctx.msBackingStorePixelRatio ||\n          ctx.oBackingStorePixelRatio ||\n          ctx.backingStorePixelRatio ||\n          1;\n        let ratio = dpr / bsr;\n        let viewport = page.getViewport({ scale: this.pdfScale });\n        canvas.width = viewport.width * ratio;\n        canvas.height = viewport.height * ratio;\n\n        canvas.style.width = viewport.width + 'px';\n\n        that.pdfWidth = viewport.width + 'px';\n\n        canvas.style.height = viewport.height + 'px';\n\n        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);\n        // 将 PDF 页面渲染到 canvas 上下文中\n        let renderContext = {\n          canvasContext: ctx,\n          viewport: viewport\n        };\n        page.render(renderContext);\n        if (this.pdfPages > num) {\n          this.renderPage(num + 1);\n        }\n      });\n    }\n  }\n};\n</script>\n<style>\n.preview-pdf h1 {\n  margin: 30px auto;\n  text-align: center;\n  font-family: '宋体';\n  letter-spacing: 2px;\n}\n</style>\n"]}]}