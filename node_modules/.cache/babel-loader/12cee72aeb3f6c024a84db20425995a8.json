{"remainingRequest":"G:\\pdf\\node_modules\\babel-loader\\lib\\index.js!G:\\pdf\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!G:\\pdf\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!G:\\pdf\\src\\components\\previewPDF.vue?vue&type=script&lang=js&","dependencies":[{"path":"G:\\pdf\\src\\components\\previewPDF.vue","mtime":1611730765892},{"path":"G:\\pdf\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1602294150526},{"path":"G:\\pdf\\node_modules\\babel-loader\\lib\\index.js","mtime":1606880660519},{"path":"G:\\pdf\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1602294150526},{"path":"G:\\pdf\\node_modules\\vue-loader\\lib\\index.js","mtime":1608703742340}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KdmFyIFBERkpTID0gcmVxdWlyZSgncGRmanMtZGlzdCcpOwoKUERGSlMuR2xvYmFsV29ya2VyT3B0aW9ucy53b3JrZXJTcmMgPSAnaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvcGRmLmpzLzIuNS4yMDcvcGRmLndvcmtlci5qcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcGRmUGFnZXM6IFtdLAogICAgICAvLyDpobXmlbAKICAgICAgcGRmV2lkdGg6ICcnLAogICAgICAvLyDlrr3luqYKICAgICAgcGRmU3JjOiAnJywKICAgICAgLy8g5Zyw5Z2ACiAgICAgIHBkZkRvYzogJycsCiAgICAgIC8vIOaWh+aho+WGheWuuQogICAgICBwZGZTY2FsZTogMS4wIC8vIOaUvuWkp+WAjeaVsAoKICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5nZXRQZGZVcmwoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFBkZlVybDogZnVuY3Rpb24gZ2V0UGRmVXJsKCkgewogICAgICAvLyB0b2RvIOivt+axguWQjuWPsO+8jOiOt+WPlnBkZueahHVybO+8jOi/memHjOeUqOeahOaYr+e6v+S4iueahOWcsOWdgAogICAgICB0aGlzLnBkZlNyYyA9ICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vbW96aWxsYS9wZGYuanMvYmEyZWRlYWUvd2ViL2NvbXByZXNzZWQudHJhY2Vtb25rZXktcGxkaS0wOS5wZGYnOwogICAgICB0aGlzLmxvYWRGaWxlKHRoaXMucGRmU3JjKTsKICAgIH0sCiAgICBsb2FkRmlsZTogZnVuY3Rpb24gbG9hZEZpbGUodXJsKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB2YXIgbG9hZGluZ1Rhc2sgPSBQREZKUy5nZXREb2N1bWVudCh1cmwpOwogICAgICBsb2FkaW5nVGFzay5wcm9taXNlLnRoZW4oZnVuY3Rpb24gKHBkZikgewogICAgICAgIF90aGlzLnBkZkRvYyA9IHBkZjsKICAgICAgICBfdGhpcy5wZGZQYWdlcyA9IHBkZi5udW1QYWdlczsKCiAgICAgICAgX3RoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzLnJlbmRlclBhZ2UoMSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlbmRlclBhZ2U6IGZ1bmN0aW9uIHJlbmRlclBhZ2UobnVtKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICB0aGlzLnBkZkRvYy5nZXRQYWdlKG51bSkudGhlbihmdW5jdGlvbiAocGFnZSkgewogICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGRmQ2FudmFzJyArIG51bSk7CiAgICAgICAgdmFyIGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpOwogICAgICAgIHZhciBkcHIgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxOwogICAgICAgIHZhciBic3IgPSBjdHgud2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjdHgubW96QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjdHgubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGN0eC5vQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCBjdHguYmFja2luZ1N0b3JlUGl4ZWxSYXRpbyB8fCAxOwogICAgICAgIHZhciByYXRpbyA9IGRwciAvIGJzcjsKICAgICAgICB2YXIgdmlld3BvcnQgPSBwYWdlLmdldFZpZXdwb3J0KHsKICAgICAgICAgIHNjYWxlOiBfdGhpczIucGRmU2NhbGUKICAgICAgICB9KTsKICAgICAgICBjYW52YXMud2lkdGggPSB2aWV3cG9ydC53aWR0aCAqIHJhdGlvOwogICAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQgKiByYXRpbzsKICAgICAgICBjYW52YXMuc3R5bGUud2lkdGggPSB2aWV3cG9ydC53aWR0aCArICdweCc7CiAgICAgICAgdGhhdC5wZGZXaWR0aCA9IHZpZXdwb3J0LndpZHRoICsgJ3B4JzsKICAgICAgICBjYW52YXMuc3R5bGUuaGVpZ2h0ID0gdmlld3BvcnQuaGVpZ2h0ICsgJ3B4JzsKICAgICAgICBjdHguc2V0VHJhbnNmb3JtKHJhdGlvLCAwLCAwLCByYXRpbywgMCwgMCk7IC8vIOWwhiBQREYg6aG16Z2i5riy5p+T5YiwIGNhbnZhcyDkuIrkuIvmlofkuK0KCiAgICAgICAgdmFyIHJlbmRlckNvbnRleHQgPSB7CiAgICAgICAgICBjYW52YXNDb250ZXh0OiBjdHgsCiAgICAgICAgICB2aWV3cG9ydDogdmlld3BvcnQKICAgICAgICB9OwogICAgICAgIHBhZ2UucmVuZGVyKHJlbmRlckNvbnRleHQpOwoKICAgICAgICBpZiAoX3RoaXMyLnBkZlBhZ2VzID4gbnVtKSB7CiAgICAgICAgICBfdGhpczIucmVuZGVyUGFnZShudW0gKyAxKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["previewPDF.vue"],"names":[],"mappings":";;;;;;;;;;;;AAaA,IAAA,KAAA,GAAA,OAAA,CAAA,YAAA,CAAA;;AACA,KAAA,CAAA,mBAAA,CAAA,SAAA,GACA,qEADA;AAEA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,EADA;AACA;AACA,MAAA,QAAA,EAAA,EAFA;AAEA;AACA,MAAA,MAAA,EAAA,EAHA;AAGA;AACA,MAAA,MAAA,EAAA,EAJA;AAIA;AACA,MAAA,QAAA,EAAA,GALA,CAKA;;AALA,KAAA;AAOA,GATA;AAUA,EAAA,OAVA,qBAUA;AACA,SAAA,SAAA;AACA,GAZA;AAaA,EAAA,OAAA,EAAA;AACA,IAAA,SADA,uBACA;AACA;AACA,WAAA,MAAA,GACA,kGADA;AAEA,WAAA,QAAA,CAAA,KAAA,MAAA;AACA,KANA;AAOA,IAAA,QAPA,oBAOA,GAPA,EAOA;AAAA;;AACA,UAAA,WAAA,GAAA,KAAA,CAAA,WAAA,CAAA,GAAA,CAAA;AACA,MAAA,WAAA,CAAA,OAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,KAAA,CAAA,MAAA,GAAA,GAAA;AACA,QAAA,KAAA,CAAA,QAAA,GAAA,GAAA,CAAA,QAAA;;AACA,QAAA,KAAA,CAAA,SAAA,CAAA,YAAA;AACA,UAAA,KAAA,CAAA,UAAA,CAAA,CAAA;AACA,SAFA;AAGA,OANA;AAOA,KAhBA;AAiBA,IAAA,UAjBA,sBAiBA,GAjBA,EAiBA;AAAA;;AACA,UAAA,IAAA,GAAA,IAAA;AACA,WAAA,MAAA,CAAA,OAAA,CAAA,GAAA,EAAA,IAAA,CAAA,UAAA,IAAA,EAAA;AACA,YAAA,MAAA,GAAA,QAAA,CAAA,cAAA,CAAA,cAAA,GAAA,CAAA;AACA,YAAA,GAAA,GAAA,MAAA,CAAA,UAAA,CAAA,IAAA,CAAA;AACA,YAAA,GAAA,GAAA,MAAA,CAAA,gBAAA,IAAA,CAAA;AACA,YAAA,GAAA,GACA,GAAA,CAAA,4BAAA,IACA,GAAA,CAAA,yBADA,IAEA,GAAA,CAAA,wBAFA,IAGA,GAAA,CAAA,uBAHA,IAIA,GAAA,CAAA,sBAJA,IAKA,CANA;AAOA,YAAA,KAAA,GAAA,GAAA,GAAA,GAAA;AACA,YAAA,QAAA,GAAA,IAAA,CAAA,WAAA,CAAA;AAAA,UAAA,KAAA,EAAA,MAAA,CAAA;AAAA,SAAA,CAAA;AACA,QAAA,MAAA,CAAA,KAAA,GAAA,QAAA,CAAA,KAAA,GAAA,KAAA;AACA,QAAA,MAAA,CAAA,MAAA,GAAA,QAAA,CAAA,MAAA,GAAA,KAAA;AAEA,QAAA,MAAA,CAAA,KAAA,CAAA,KAAA,GAAA,QAAA,CAAA,KAAA,GAAA,IAAA;AAEA,QAAA,IAAA,CAAA,QAAA,GAAA,QAAA,CAAA,KAAA,GAAA,IAAA;AAEA,QAAA,MAAA,CAAA,KAAA,CAAA,MAAA,GAAA,QAAA,CAAA,MAAA,GAAA,IAAA;AAEA,QAAA,GAAA,CAAA,YAAA,CAAA,KAAA,EAAA,CAAA,EAAA,CAAA,EAAA,KAAA,EAAA,CAAA,EAAA,CAAA,EAtBA,CAuBA;;AACA,YAAA,aAAA,GAAA;AACA,UAAA,aAAA,EAAA,GADA;AAEA,UAAA,QAAA,EAAA;AAFA,SAAA;AAIA,QAAA,IAAA,CAAA,MAAA,CAAA,aAAA;;AACA,YAAA,MAAA,CAAA,QAAA,GAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,UAAA,CAAA,GAAA,GAAA,CAAA;AACA;AACA,OAhCA;AAiCA;AApDA;AAbA,CAAA","sourcesContent":["<template>\n  <div class=\"preview-pdf\">\n    <h1>PDF在线预览</h1>\n    <div :style=\"`margin:0 auto;width:${pdfWidth};`\">\n      <canvas\n        v-for=\"page in pdfPages\"\n        :key=\"page\"\n        :id=\"'pdfCanvas' + page\"\n      ></canvas>\n    </div>\n  </div>\n</template>\n<script>\nconst PDFJS = require('pdfjs-dist');\nPDFJS.GlobalWorkerOptions.workerSrc =\n  'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.5.207/pdf.worker.js';\nexport default {\n  data() {\n    return {\n      pdfPages: [], // 页数\n      pdfWidth: '', // 宽度\n      pdfSrc: '', // 地址\n      pdfDoc: '', // 文档内容\n      pdfScale: 1.0 // 放大倍数\n    };\n  },\n  mounted() {\n    this.getPdfUrl();\n  },\n  methods: {\n    getPdfUrl() {\n      // todo 请求后台，获取pdf的url，这里用的是线上的地址\n      this.pdfSrc =\n        'https://raw.githubusercontent.com/mozilla/pdf.js/ba2edeae/web/compressed.tracemonkey-pldi-09.pdf';\n      this.loadFile(this.pdfSrc);\n    },\n    loadFile(url) {\n      let loadingTask = PDFJS.getDocument(url);\n      loadingTask.promise.then((pdf) => {\n        this.pdfDoc = pdf;\n        this.pdfPages = pdf.numPages;\n        this.$nextTick(() => {\n          this.renderPage(1);\n        });\n      });\n    },\n    renderPage(num) {\n      const that = this;\n      this.pdfDoc.getPage(num).then((page) => {\n        let canvas = document.getElementById('pdfCanvas' + num);\n        let ctx = canvas.getContext('2d');\n        let dpr = window.devicePixelRatio || 1;\n        let bsr =\n          ctx.webkitBackingStorePixelRatio ||\n          ctx.mozBackingStorePixelRatio ||\n          ctx.msBackingStorePixelRatio ||\n          ctx.oBackingStorePixelRatio ||\n          ctx.backingStorePixelRatio ||\n          1;\n        let ratio = dpr / bsr;\n        let viewport = page.getViewport({ scale: this.pdfScale });\n        canvas.width = viewport.width * ratio;\n        canvas.height = viewport.height * ratio;\n\n        canvas.style.width = viewport.width + 'px';\n\n        that.pdfWidth = viewport.width + 'px';\n\n        canvas.style.height = viewport.height + 'px';\n\n        ctx.setTransform(ratio, 0, 0, ratio, 0, 0);\n        // 将 PDF 页面渲染到 canvas 上下文中\n        let renderContext = {\n          canvasContext: ctx,\n          viewport: viewport\n        };\n        page.render(renderContext);\n        if (this.pdfPages > num) {\n          this.renderPage(num + 1);\n        }\n      });\n    }\n  }\n};\n</script>\n<style>\n.preview-pdf h1 {\n  margin: 30px auto;\n  text-align: center;\n  font-family: '宋体';\n  letter-spacing: 2px;\n}\n</style>\n"],"sourceRoot":"src/components"}]}